<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Electronic_Store</title>
  <link rel="stylesheet" href="style1.css" />

  <style>
    :root {
      --bg: #f3f6fb;
      --card: #ffffff;
      --accent: #0066cc;
      --accent-2: #0b74de;
      --muted: #6b7280;
      --success: #16a34a;
    }

    * {
      box-sizing: border-box
    }

    html,
    body {
      height: 100%;
      margin: 0;
      font-family: Inter, "Segoe UI", Arial;
      background: var(--bg);
    }

    /* keep page header */
    .title {
      padding: 18px 24px;
      margin: 0;
    }

    /* --- Demo/cart layout --- */
    .demo-wrap {
      display: grid;
      grid-template-columns: 1fr 360px;
      gap: 18px;
      align-items: start;
      margin: 24px
    }

    @media (max-width:980px) {
      .demo-wrap {
        grid-template-columns: 1fr;
        padding: 0 12px
      }
    }

    .card {
      background: var(--card);
      border-radius: 10px;
      padding: 12px;
      box-shadow: 0 4px 18px rgba(11, 30, 60, 0.06)
    }

    .card img {
      width: 100%;
      height: 140px;
      object-fit: cover;
      border-radius: 8px
    }

    .card .title {
      font-weight: 700;
      margin-top: 8px
    }

    .card .price {
      color: var(--accent);
      font-weight: 700;
      margin-top: 6px
    }

    .card button {
      margin-top: 8px
    }

    /* Cart */
    .cart {
      position: sticky;
      top: 18px
    }

    .cart .header {
      display: flex;
      justify-content: space-between;
      align-items: center
    }

    .cart-list {
      margin-top: 10px;
      max-height: 360px;
      overflow: auto
    }

    .cart-row {
      display: flex;
      gap: 8px;
      padding: 8px;
      border-radius: 8px;
      align-items: center
    }

    .cart-row img {
      width: 56px;
      height: 44px;
      object-fit: cover;
      border-radius: 6px
    }

    .cart-row .c-info {
      flex: 1
    }

    .cart-footer {
      background: #fbfdff;
      padding: 10px;
      border-radius: 8px;
      margin-top: 12px
    }

    .total {
      font-weight: 800;
      font-size: 18px
    }

    /* Buttons */
    .btn {
      background: var(--accent);
      color: white;
      border: none;
      padding: 8px 10px;
      border-radius: 8px;
      cursor: pointer
    }

    .btn.secondary {
      background: #eef2ff;
      color: var(--accent-2)
    }

    .btn.small {
      padding: 6px 8px;
      font-size: 13px
    }

    /* Active filter button */
    .filter-btn.active {
      background: var(--accent-2);
      color: #fff;
      border-radius: 6px;
      box-shadow: 0 4px 14px rgba(11, 30, 60, 0.08);
    }

    /* --- Overlay & modal fixes (make overlay truly fullscreen + high z-index) --- */
    .overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      /* ensure full viewport height */
      display: none;
      align-items: center;
      justify-content: center;
      background: rgba(0, 0, 0, 0.45);
      z-index: 99999;
      /* very high so it sits on top */
      padding: 20px;
      /* safe spacing on small screens */
      box-sizing: border-box;
      overflow: auto;
      /* allow scrolling if modal taller than viewport */
    }

    .overlay.show {
      display: flex !important;
      align-items: center;
      justify-content: center;
    }

    .modal {
      background: var(--card);
      width: 420px;
      max-width: 95%;
      border-radius: 10px;
      padding: 16px;
      box-shadow: 0 18px 40px rgba(2, 6, 23, 0.2)
    }

    .modal h2 {
      margin: 0 0 8px 0
    }

    .modal.printable {
      max-width: 95%;
      width: 720px
    }

    label {
      font-size: 13px;
      color: var(--muted)
    }

    input[type=text],
    input[type=tel],
    input[type=month] {
      width: 100%;
      padding: 8px;
      margin-top: 6px;
      border-radius: 6px;
      border: 1px solid #e6eefc
    }

    .muted {
      color: var(--muted);
      font-size: 13px
    }

    .success-msg {
      color: var(--success);
      font-weight: 700
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 8px
    }

    th,
    td {
      padding: 8px;
      text-align: left;
      border-bottom: 1px solid #f1f5f9
    }

    .right {
      text-align: right
    }

    @media (max-width:420px) {
      .modal {
        padding: 12px
      }

      .modal h2 {
        font-size: 16px
      }
    }

    /* small toast */
    .toast {
      position: fixed;
      right: 18px;
      top: 18px;
      background: rgba(2, 6, 23, 0.92);
      color: #fff;
      padding: 8px 12px;
      border-radius: 8px;
      box-shadow: 0 8px 28px rgba(2, 6, 23, 0.25);
      z-index: 100000;
      display: none;
      font-size: 14px;
    }

    .toast.show {
      display: block;
      opacity: 1;
      transition: opacity .2s;
    }
  </style>
</head>

<body>

  <main>
    <h1 class="title">Welcome to the SoRav Electronic Store</h1>
  </main>

  <!-- Products section (kept your original content but ensured Add buttons have .add-to-cart) -->
  <section class="products-section">
    <div class="container" style="padding:0 24px;">
      <div class="products-top"
        style="display:flex; justify-content:space-between; align-items:center; gap:12px; flex-wrap:wrap;">
        <h2 style="margin:0">Our Products</h2>
        <div style="display:flex; gap:8px; align-items:center; flex-wrap:wrap;">
          <div class="filters" style="display:flex; gap:8px;">
            <button class="filter-btn" data-cat="all">All</button>
            <button class="filter-btn" data-cat="mobile">Mobile</button>
            <button class="filter-btn" data-cat="laptop">Laptop</button>
            <button class="filter-btn" data-cat="tv">TV</button>
          </div>
          <button id="products-toggle" class="mobile-toggle" aria-label="toggle products">☰</button>
        </div>
      </div>

      <div class="product-grid" id="productGrid"
        style="display:grid; grid-template-columns: repeat(auto-fill,minmax(260px,1fr)); gap:16px; margin-top:18px;">
        <!-- Product 1 -->
        <article class="product-card" data-cat="mobile" style="background:#fff; border-radius:10px; padding:12px;">
          <div class="img-wrap">
            <img class="img-1" src="Img/mob-1.jpg" alt="Smartphone" style="element.style {
    width: 58%;
    height: 160px;
    object-fit: cover;
    border-radius: 8px;
}">
          </div>
          <h3>Samsung Galaxy S24 FE 5G (Mint, 8GB RAM)</h3>
          <p class="desc">Latest 5G smartphone with high performance and camera.</p>
          <div class="card-foot" style="display:flex; justify-content:space-between; align-items:center;">
            <span class="price">₹38,999</span>
            <button class="btn add-to-cart">Add to Cart</button>
          </div>
        </article>

        <!-- Product 2 -->
        <article class="product-card" data-cat="laptop" style="background:#fff; border-radius:10px; padding:12px;">
          <div class="img-wrap">
            <img src="Img/lap-1.jpg" alt="Laptop"
              style="element.style {
    width: 58%;
    height: 160px;
    object-fit: cover;
    border-radius: 8px;
}">
          </div>
          <h3>HP Victous Laptop</h3>
          <p class="desc">Fast, powerful laptop for work and gaming.</p>
          <div class="card-foot" style="display:flex; justify-content:space-between; align-items:center;">
            <span class="price">₹54,999</span>
            <button class="btn add-to-cart">Add to Cart</button>
          </div>
        </article>

        <!-- Product 3 -->
        <article class="product-card" data-cat="tv" style="background:#fff; border-radius:10px; padding:12px;">
          <div class="img-wrap">
            <img src="Img/Led-1.jpg" alt="Smart TV"
              style="element.style {
    width: 58%;
    height: 160px;
    object-fit: cover;
    border-radius: 8px;
}">
          </div>
          <h3>Smart LED TV</h3>
          <p class="desc">Ultra HD Smart TV with vibrant display.</p>
          <div class="card-foot" style="display:flex; justify-content:space-between; align-items:center;">
            <span class="price">₹65,499</span>
            <button class="btn add-to-cart">Add to Cart</button>
          </div>
        </article>

        <!-- Product 4 -->
        <article class="product-card" data-cat="mobile" style="background:#fff; border-radius:10px; padding:12px;">
          <div class="img-wrap">
            <img src="Img/mob-2.jpg" alt="Smartphone"
              style="element.style {
    width: 58%;
    height: 160px;
    object-fit: cover;
    border-radius: 8px;
}">
          </div>
          <h3>Samsung Galaxy S24 Ultra 5G</h3>
          <p class="desc">Powerful smartphone with advanced features.</p>
          <div class="card-foot" style="display:flex; justify-content:space-between; align-items:center;">
            <span class="price">₹1,29,999</span>
            <button class="btn add-to-cart">Add to Cart</button>
          </div>
        </article>

        <!-- Product 5 -->
        <article class="product-card" data-cat="mobile" style="background:#fff; border-radius:10px; padding:12px;">
          <div class="img-wrap">
            <img src="Img/mob-3.jpg" alt="Google Pixel 10"
              style="element.style {
    width: 58%;
    height: 160px;
    object-fit: cover;
    border-radius: 8px;
}">
          </div>
          <h3>Google Pixel 10</h3>
          <p class="desc">Experience the best of Google with Pixel 10.</p>
          <div class="card-foot" style="display:flex; justify-content:space-between; align-items:center;">
            <span class="price">₹79,999</span>
            <button class="btn add-to-cart">Add to Cart</button>
          </div>
        </article>

        <!-- Product 6 -->
        <article class="product-card" data-cat="tv" style="background:#fff; border-radius:10px; padding:12px;">
          <div class="img-wrap">
            <img src="Img/sst-2.jpg" alt="Samsung TV"
              style="element.style {
    width: 58%;
    height: 160px;
    object-fit: cover;
    border-radius: 8px;
}">
          </div>
          <h3>Samsung 65" Neo QLED (8K)</h3>
          <p class="desc">Experience stunning 8K resolution with Samsung Neo QLED TV.</p>
          <div class="card-foot" style="display:flex; justify-content:space-between; align-items:center;">
            <span class="price">₹3,99,999</span>
            <button class="btn add-to-cart">Add to Cart</button>
          </div>
        </article>

        <!-- Product 7 -->
        <article class="product-card" data-cat="mobile" style="background:#fff; border-radius:10px; padding:12px;">
          <div class="img-wrap">
            <img src="Img/mob-4.jpg" alt="OnePlus Nord 3"
              style="element.style {
    width: 58%;
    height: 160px;
    object-fit: cover;
    border-radius: 8px;
}">
          </div>
          <h3>OnePlus Nord 3 5G</h3>
          <p class="desc">Smooth performance with OnePlus Nord 3 5G.</p>
          <div class="card-foot" style="display:flex; justify-content:space-between; align-items:center;">
            <span class="price">₹29,999</span>
            <button class="btn add-to-cart">Add to Cart</button>
          </div>
        </article>

        <!-- Product 8 -->
        <article class="product-card" data-cat="mobile" style="background:#fff; border-radius:10px; padding:12px;">
          <div class="img-wrap">
            <img src="Img/mob-5.jpg" alt="Samsung Galaxy S25 5G"
              style="element.style {
    width: 58%;
    height: 160px;
    object-fit: cover;
    border-radius: 8px;
}">
          </div>
          <h3>Samsung Galaxy S25 5G (Icyblue, 512 GB) (12 GB RAM)</h3>
          <p class="desc">The ultimate Mobile experience with amazing features.</p>
          <div class="card-foot" style="display:flex; justify-content:space-between; align-items:center;">
            <span class="price">₹92,999</span>
            <button class="btn add-to-cart">Add to Cart</button>
          </div>
        </article>

        <!-- Product 9 -->
        <article class="product-card" data-cat="laptop" style="background:#fff; border-radius:10px; padding:12px;">
          <div class="img-wrap">
            <img src="Img/lap-2.jpg" alt="Hp Omen Laptop"
              style="element.style {
    width: 58%;
    height: 160px;
    object-fit: cover;
    border-radius: 8px;
}">
          </div>
          <h3>HP OMEN Intel Core i9 14th Gen 14900HX - (24 GB/1 TB SSD/Windows 11 Home/8 GB Graphics/NVIDIA GeForce RTX
            5060)</h3>
          <p class="desc">Intel Core i9 Processor (14th Gen) 24 GB DDR5 RAM Windows 11 Home Operating System 1 TB SSD
            40.64 cm (16 inch) Display 1 Year Onsite Warranty.</p>
          <div class="card-foot" style="display:flex; justify-content:space-between; align-items:center;">
            <span class="price">₹1,57,990</span>
            <button class="btn add-to-cart">Add to Cart</button>
          </div>
        </article>

      </div>
    </div>
  </section>

  <!-- Demo cart/payment area -->
  <div class="demo-wrap" aria-hidden="false">
    <div>
      <div class="card" style="margin-bottom:12px">
        <div style="display:flex; justify-content:space-between; align-items:center">
          <div>
            <div style="font-weight:800">Cart demo</div>
            <div class="muted">Click <strong>Add to Cart</strong> on any product. Then click <strong>Checkout</strong>.
            </div>
          </div>
        </div>
      </div>

      <div id="productsDemo" style="display:none"></div>
    </div>

    <aside class="cart card">
      <div class="cart" id="cartBox">
        <div class="header">
          <div>
            <div style="font-weight:800">Cart</div>
            <div class="muted" id="cartCount">0 items</div>
          </div>
          <button class="btn small" id="clearCartBtn">Clear</button>
        </div>

        <div class="cart-list" id="cartList"></div>

        <div class="cart-footer">
          <div style="display:flex; justify-content:space-between; align-items:center">
            <div class="muted">Subtotal</div>
            <div class="total" id="subtotal">₹0</div>
          </div>
          <div style="margin-top:8px; display:flex; gap:8px">
            <button class="btn" id="checkoutBtn">Checkout</button>
            <button class="btn secondary" id="viewInvoiceBtn">View Invoice</button>
          </div>
        </div>
      </div>
    </aside>
  </div>

  <!-- PAYMENT MODAL (no redirect) -->
  <div class="overlay" id="paymentOverlay" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="payTitle">
      <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px">
        <h2 id="payTitle">Payment</h2>
        <button onclick="closePayment()" class="btn small secondary">Close</button>
      </div>

      <form id="paymentForm">
        <label>Card holder name</label>
        <input id="cardName" type="text" placeholder="Full name" required />

        <label>Card number</label>
        <input id="cardNumber" type="tel" placeholder="1234 5678 9012 3456" maxlength="19" required />

        <div style="display:flex; gap:8px; margin-top:8px">
          <div style="flex:1">
            <label>Expiry</label>
            <input id="expiry" type="month" required />
          </div>
          <div style="width:120px">
            <label>CVV</label>
            <input id="cvv" type="tel" maxlength="4" placeholder="123" required />
          </div>
        </div>

        <div style="margin-top:12px; display:flex; justify-content:space-between; align-items:center">
          <div class="muted">Total: <strong id="payTotal">₹0</strong></div>
          <div>
            <button type="button" class="btn secondary" onclick="closePayment()">Cancel</button>
            <button type="submit" class="btn">Pay</button>
          </div>
        </div>

        <p id="payMsg" class="success-msg" style="display:none; margin-top:10px">Payment successful!</p>
      </form>
    </div>
  </div>

  <div class="overlay" id="invoiceOverlay" aria-hidden="true">
    <div class="modal printable" role="dialog" aria-modal="true" style="max-width:720px">
      <div style="display:flex; justify-content:space-between; align-items:center">
        <h2>Invoice</h2>
        <div>
          <button class="btn small secondary" onclick="closeInvoice()">Close</button>
          <button class="btn small" onclick="printInvoice()">Print</button>
        </div>
      </div>

      <div class="invoice" id="invoiceContent"></div>
    </div>
  </div>

  <div class="overlay" id="miniOverlay" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" style="max-width:360px; text-align:center;">
      <h2 id="miniTitle">Added to cart</h2>
      <p id="miniMsg" class="muted" style="margin:8px 0 14px 0">Item added to cart successfully.</p>
      <div style="display:flex; gap:8px; justify-content:center;">
        <button class="btn secondary" id="continueBtn">Continue</button>
        <button class="btn" id="miniCheckoutBtn">Checkout</button>
      </div>
    </div>
  </div>

  <!-- Small toast -->
  <div class="toast" id="toast">Added to cart</div>

  <!-- JS: cart, filtering, overlays -->
  <script>
    /* Simple cart system that reads product info from each .product-card */
    let PRODUCTS = []; // internal product list: {id, name, price, img}
    let nextId = 1;
    let cart = []; // {id, qty}

    const toINR = n => '₹' + n.toLocaleString('en-IN');

    function parsePrice(str) {
      const digits = (str || '').replace(/[^0-9]/g, '');
      return digits ? parseInt(digits, 10) : 0;
    }

    function findProductByName(name) { return PRODUCTS.find(p => p.name === name) }
    function findProductById(id) { return PRODUCTS.find(p => p.id === id) }

    function ensureProductFromCard(cardEl) {
      const name = cardEl.querySelector('h3') ? cardEl.querySelector('h3').textContent.trim() : 'Unnamed';
      const priceText = cardEl.querySelector('.price') ? cardEl.querySelector('.price').textContent.trim() : '₹0';
      const imgEl = cardEl.querySelector('img');
      const img = imgEl ? imgEl.src : '';
      const price = parsePrice(priceText);

      let existing = findProductByName(name);
      if (existing) return existing.id;
      const id = nextId++;
      PRODUCTS.push({ id, name, price, img });
      return id;
    }

    function saveCart() { localStorage.setItem('sorav_cart', JSON.stringify(cart)) }
    function loadCart() { const s = localStorage.getItem('sorav_cart'); if (s) cart = JSON.parse(s) }

    function addToCartFromCard(cardEl, qty = 1) {
      const id = ensureProductFromCard(cardEl);
      const item = cart.find(it => it.id === id);
      if (item) item.qty += qty;
      else cart.push({ id, qty });
      saveCart();
      renderCart();
    }

    function removeFromCart(id) { cart = cart.filter(c => c.id !== id); saveCart(); renderCart(); }
    function changeQty(id, delta) { const it = cart.find(c => c.id === id); if (!it) return; it.qty += delta; if (it.qty < 1) removeFromCart(id); saveCart(); renderCart(); }
    function clearCart() { cart = []; saveCart(); renderCart(); }

    function cartTotal() {
      return cart.reduce((s, c) => {
        const p = findProductById(c.id);
        return s + (p ? p.price * c.qty : 0);
      }, 0);
    }

    // Render cart UI
    const cartList = document.getElementById('cartList');
    const cartCount = document.getElementById('cartCount');
    const subtotalEl = document.getElementById('subtotal');

    function renderCart() {
      cartList.innerHTML = '';
      if (cart.length === 0) {
        cartList.innerHTML = '<div class="muted" style="padding:10px">Cart is empty</div>';
      } else {
        cart.forEach(c => {
          const p = findProductById(c.id);
          const row = document.createElement('div');
          row.className = 'cart-row';
          row.innerHTML = `
            <img src="${p.img}" alt="${p.name}">
            <div class="c-info">
              <div style="font-weight:700">${p.name}</div>
              <div class="muted">${toINR(p.price)} × ${c.qty} = <strong>${toINR(p.price * c.qty)}</strong></div>
            </div>
            <div style="display:flex; flex-direction:column; gap:6px; align-items:flex-end">
              <div>
                <button class="btn small" data-plus="${c.id}">+</button>
                <button class="btn small" data-minus="${c.id}" style="margin-left:6px">-</button>
              </div>
              <button class="btn small secondary" data-remove="${c.id}">Remove</button>
            </div>
          `;
          cartList.appendChild(row);
        });
      }

      cartCount.textContent = cart.length + (cart.length === 1 ? ' item' : ' items');
      subtotalEl.textContent = toINR(cartTotal());

      // attach row buttons
      cartList.querySelectorAll('[data-plus]').forEach(b => b.addEventListener('click', e => changeQty(parseInt(e.target.dataset.plus), 1)));
      cartList.querySelectorAll('[data-minus]').forEach(b => b.addEventListener('click', e => changeQty(parseInt(e.target.dataset.minus), -1)));
      cartList.querySelectorAll('[data-remove]').forEach(b => b.addEventListener('click', e => removeFromCart(parseInt(e.target.dataset.remove))));
    }

    // Overlays elements
    const paymentOverlay = document.getElementById('paymentOverlay');
    const invoiceOverlay = document.getElementById('invoiceOverlay');
    const miniOverlay = document.getElementById('miniOverlay');
    const payTitle = document.getElementById('payTitle');
    const payTotal = document.getElementById('payTotal');
    const paymentForm = document.getElementById('paymentForm');
    const payMsg = document.getElementById('payMsg');

    function openOverlay(el) { el.classList.add('show'); el.setAttribute('aria-hidden', 'false'); document.body.style.overflow = 'hidden'; }
    function closeOverlay(el) {
      el.classList.remove('show'); el.setAttribute('aria-hidden', 'true');
      // restore scroll only if no overlays shown
      const anyShown = Array.from(document.querySelectorAll('.overlay')).some(x => x.classList.contains('show'));
      if (!anyShown) document.body.style.overflow = '';
    }

    // small toast
    const toast = document.getElementById('toast');
    function showToast(msg, ms = 900) {
      toast.textContent = msg;
      toast.classList.add('show');
      setTimeout(() => toast.classList.remove('show'), ms);
    }

    // Checkout / Payment functions
    function openPayment() {
      if (cart.length === 0) { alert('Add items to cart before checkout'); return; }
      payTitle.textContent = 'Payment — ' + cart.length + ' item(s)';
      payTotal.textContent = toINR(cartTotal());
      payMsg.style.display = 'none';
      openOverlay(paymentOverlay);
    }
    function closePayment() { closeOverlay(paymentOverlay); }

    // card number formatting
    const cardNumber = document.getElementById('cardNumber');
    if (cardNumber) {
      cardNumber.addEventListener('input', (e) => {
        let v = e.target.value.replace(/\D/g, '').slice(0, 16);
        let parts = v.match(/.{1,4}/g);
        e.target.value = parts ? parts.join(' ') : v;
      });
    }

    // payment submit (mock)
    paymentForm.addEventListener('submit', (e) => {
      e.preventDefault();
      const name = document.getElementById('cardName').value.trim();
      const num = document.getElementById('cardNumber').value.replace(/\s/g, '');
      const cvv = document.getElementById('cvv').value.trim();
      const exp = document.getElementById('expiry').value;
      if (!name || num.length < 12 || cvv.length < 3 || !exp) { alert('Please enter valid (mock) card details'); return; }

      const btn = paymentForm.querySelector('button[type=submit]');
      const old = btn.textContent; btn.textContent = 'Processing...'; btn.disabled = true;

      setTimeout(() => {
        btn.disabled = false; btn.textContent = old;
        payMsg.style.display = 'block';

        const order = createOrder();
        setTimeout(() => {
          closePayment();
          openInvoice(order);
          clearCart();
        }, 900);

      }, 1300);
    });

    // Invoice creation & display
    const invoiceContent = document.getElementById('invoiceContent');

    function createOrder() {
      const id = 'ORD' + Date.now().toString().slice(-6);
      const date = new Date();
      const items = cart.map(c => {
        const p = findProductById(c.id);
        return { name: p.name, price: p.price, qty: c.qty, total: p.price * c.qty };
      });
      const subtotal = cartTotal();
      const tax = Math.round(subtotal * 0.18);
      const shipping = subtotal > 5000 ? 0 : 99;
      const grand = subtotal + tax + shipping;
      return { id, date, items, subtotal, tax, shipping, grand };
    }

    function createOrderPreview() {
      const id = 'PREVIEW' + Math.floor(Math.random() * 9000 + 1000);
      const date = new Date();
      const items = cart.map(c => { const p = findProductById(c.id); return { name: p.name, price: p.price, qty: c.qty, total: p.price * c.qty }; });
      const subtotal = cartTotal();
      const tax = Math.round(subtotal * 0.18);
      const shipping = subtotal > 5000 ? 0 : 99;
      const grand = subtotal + tax + shipping;
      return { id, date, items, subtotal, tax, shipping, grand };
    }

    function renderInvoiceHTML(order) {
      const d = new Date(order.date);
      const dateStr = d.toLocaleString('en-IN');
      const itemsRows = order.items.map(it => `<tr><td>${it.name}</td><td class="right">${it.qty}</td><td class="right">${toINR(it.price)}</td><td class="right">${toINR(it.total)}</td></tr>`).join('');
      return `
        <div class="inv-header" style="display:flex; justify-content:space-between; align-items:center">
          <div>
            <div style="font-weight:800; font-size:18px">SoRav Electronic Store</div>
            <div class="muted">Your address here</div>
          </div>
          <div style="text-align:right">
            <div><strong>Invoice #</strong> ${order.id}</div>
            <div class="muted">${dateStr}</div>
          </div>
        </div>

        <table style="margin-top:12px">
          <thead>
            <tr><th>Item</th><th class="right">Qty</th><th class="right">Price</th><th class="right">Total</th></tr>
          </thead>
          <tbody>
            ${itemsRows}
          </tbody>
        </table>

        <div style="display:flex; justify-content:flex-end; margin-top:12px">
          <div style="width:320px">
            <table style="width:100%">
              <tr><td>Subtotal</td><td class="right">${toINR(order.subtotal)}</td></tr>
              <tr><td>GST (18%)</td><td class="right">${toINR(order.tax)}</td></tr>
              <tr><td>Shipping</td><td class="right">${toINR(order.shipping)}</td></tr>
              <tr><td style="font-weight:800; padding-top:8px">Grand Total</td><td class="right" style="font-weight:800; padding-top:8px">${toINR(order.grand)}</td></tr>
            </table>
          </div>
        </div>

        <div style="margin-top:14px; display:flex; justify-content:space-between; align-items:center">
          <div class="muted">Payment Method: Card (mock)</div>
          <div style="color:var(--success); font-weight:800">Order placed successfully ✅</div>
        </div>
      `;
    }

    function openInvoice(orderData = null) {
      let order = orderData || createOrderPreview();
      invoiceContent.innerHTML = renderInvoiceHTML(order);
      openOverlay(invoiceOverlay);
    }
    function closeInvoice() { closeOverlay(invoiceOverlay); }

    function printInvoice() { window.print(); }

    // Click outside overlays to close
    document.querySelectorAll('.overlay').forEach(o => {
      o.addEventListener('click', (e) => {
        if (e.target === o) { closeOverlay(o); }
      });
    });

    // Wire Add to Cart + show mini modal (with Checkout)
    document.addEventListener('DOMContentLoaded', () => {
      loadCart();

      // Attach add-to-cart listeners
      document.querySelectorAll('.product-card .add-to-cart').forEach(btn => {
        btn.addEventListener('click', (e) => {
          const card = e.target.closest('.product-card');
          if (!card) return;
          addToCartFromCard(card, 1);
          showToast('Added to cart');

          // update mini modal text
          const titleEl = document.getElementById('miniTitle');
          const msgEl = document.getElementById('miniMsg');
          const productName = card.querySelector('h3') ? card.querySelector('h3').textContent.trim() : 'Item';
          titleEl.textContent = 'Added: ' + productName;
          msgEl.textContent = 'Item added to cart successfully.';

          // show small modal with Checkout option
          openOverlay(miniOverlay);
        });
      });

      // Mini modal buttons
      document.getElementById('continueBtn').addEventListener('click', () => { closeOverlay(miniOverlay); });
      document.getElementById('miniCheckoutBtn').addEventListener('click', () => {
        closeOverlay(miniOverlay);
        openPayment();
      });

      // Cart control buttons
      document.getElementById('clearCartBtn').addEventListener('click', () => { if (confirm('Clear cart?')) clearCart() });
      document.getElementById('viewInvoiceBtn').addEventListener('click', () => { if (cart.length === 0) { alert('Cart is empty'); return } openInvoice(); });
      document.getElementById('checkoutBtn').addEventListener('click', () => { openPayment(); });

      renderCart();

      // Category filtering
      const filterBtns = document.querySelectorAll('.filter-btn');
      const productCards = document.querySelectorAll('.product-card');
      if (filterBtns.length && productCards.length) {
        function applyFilter(cat) {
          productCards.forEach(card => {
            const cardCat = (card.dataset.cat || '').trim();
            if (cat === 'all' || cardCat === cat) card.style.display = '';
            else card.style.display = 'none';
          });
        }
        filterBtns.forEach(btn => {
          btn.addEventListener('click', () => {
            const cat = btn.getAttribute('data-cat') || 'all';
            filterBtns.forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            applyFilter(cat);
            // scroll to top of product grid (helpful on mobile)
            document.getElementById('productGrid').scrollIntoView({ behavior: 'smooth' });
          });
        });
        // Init with 'all' active if present
        const initial = document.querySelector('.filter-btn[data-cat="all"]') || filterBtns[0];
        if (initial) initial.click();
      }
    }); // DOMContentLoaded end
  </script>

  <!-- keep external site JS if you have other logic (optional) -->
  <script src="JS/index.js"></script>
</body>

</html>